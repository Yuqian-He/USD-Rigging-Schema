# Houdini Mesh Plugin

## Introduce
The Houdini skeleton plugin, developed as an integral component of this project, represents an innovative application of the C++ [Houdini Development Kit (HDK)](https://www.sidefx.com/docs/hdk/index.html). This tailored plugin is specifically engineered to import skeleton data from a USD file that has been exported using the bespoke [Maya skeleton USD plugin](https://github.com/Yuqian-He/USD-Rigging-Schema/tree/main/mayaSkeletonUsd). It opens the USD file and retrieves the skeleton's data, including bind transforms, joint names, and joint paths. It then processes this data and creates bone objects in the Houdini scene based on the skeleton information. The bone objects are represented as polygons connecting joints and are positioned using the computed world transforms for each joint. 

## File Structure
- SOP_testSkeleton.C : This is the main script to generate custom "testSkeletonUSD" SOP in Houdini
- SOP_testSkeleton.o : This is automatically generated by running "hcustom" command, which will be mentioned after
- SOP_testSkeleton.proto.h : This is automatically generated after building SOP_testSkeleton.C in build file, an embedded DS file for specifying the parameter interface. Remember to replace the new generated SOP_testSkeleton.proto.h file of this file (this file was generated during my test)

## How to build (only test on macOS)

### Before start 
Remember to replace all the path in CMakeLists.txt to fit your version of Houdini and USD, as I didn't figure it out how to automatically adapt to all user's path. I'm on macOS, so most of the path should be the seam, but you should still check yours in case it doesn't look right.

1. line 9 --> the path to your Houdini toolkit cmake
2. line 15 --> the path to your Houdini toolkit include
3. line 16 --> the path to your Houdini libraries
4. line 40 --> the path to your Houdini python version link
If you have a different version of my Houdini, double check the link libraries name is correct or not (line 42-46). As I know maya 2023 and 2024 has a different link libraries name. (all my libraries are in "/Applications/Houdini/Houdini19.5.534/Frameworks/Houdini.framework/Libraries/")

### Build SOP_importUSD.C
```c
//under the folder HoudiniSkeletonUsd
mkdir build
cmake ..
make
cp SOP_testSkeleton.proto.h ../
```

### build external C++ code into dynamic libraries
"hcustom" is a command-line utility provided by SideFX, to compile custom plugins and extensions for Houdini. It is used to build external C++ code into dynamic libraries (DLLs or shared objects) that can be loaded into Houdini as custom nodes, operators, or other extensions.

```c
//under the folder HoudiniMeshUsd
hcustom SOP_testSkeleton.C
```
If give the error of "HFS: Undefined variable." You need to setup Houdini environment first

```c
//under Houdini Resources path 
//mine is: /Applications/Houdini/Houdini19.5.534/Frameworks/Houdini.framework/Versions/19.5/Resources/
source houdini_setup
```

### Test in Houdini
After all these steps, you will find a SOP called "testSkeletonUSD" under custom.







